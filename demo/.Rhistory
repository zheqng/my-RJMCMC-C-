log.P
return(log.P)
}
#####################################
tempdata = read.table("testdata.dat",fill=TRUE)
14*96
ii=1
x = seq(ii,ii+96)
y = tempdata[ii,ii+96]
x.new = ii+97
calc.z.2(x,y,theta[[200]])
vector
?vector
as.vector(rep(0,2))
print.posterior.1<-function(x,y,thet){
norm =0.0;log.P = as.vector(rep(0,thet$K))
# log.P = rep(0,3)
for(k in 1:(thet$K)){
log.P[k] = my.dmultinorm(x = y,mu = rep(0,length(y)),sigma=exp.cov.noise(x,thet,k),log=TRUE)
}
log.P
return(log.P)
}
calc.z.2(x,y,theta[[200]])
my.dmultinorm<-function(x,mu = rep(0,length(x)),sigma,log=TRUE){
Nm = length(x)
# x = t(x)
log.d =  -t(x)%*%solve(sigma,x)/2.0 - Nm/2.0 * log(2.0 * 3.14159) - 1/2 * log(abs(det(sigma)))
if(log==TRUE) return(log.d)
else return(exp(log.d))
}
calc.z.2(x,y,theta[[200]])
Nm = length(y)
y
y = tempdata[ii,ii+96]
y = tempdata[ii:(ii+96)]
x = seq(ii,ii+95)
y = tempdata[ii:(ii+95)]
x.new = ii+96
calc.z.2(x,y,theta[[200]])
Nm = length(y)
igma=exp.cov.noise(x,theta[[200]],1)
sigma=exp.cov.noise(x,theta[[200]],1)
y = t(y)
solve(sigma,y)
my.dmultinorm<-function(x,mu = rep(0,length(x)),sigma,log=TRUE){
Nm = length(x)
x = t(x)
log.d =  -t(x)%*%solve(sigma,x)/2.0 - Nm/2.0 * log(2.0 * 3.14159) - 1/2 * log(abs(det(sigma)))
if(log==TRUE) return(log.d)
else return(exp(log.d))
}
x = seq(ii,ii+95)
y = tempdata[ii:(ii+95)]
x.new = ii+96
calc.z.2(x,y,theta[[200]])
thet = theta[[200]]
norm =0.0;log.P = as.vector(rep(0,thet$K))
k=2
k=1
my.dmultinorm(x = y,mu = rep(0,length(y)),sigma=exp.cov.noise(x,thet,k),log=TRUE)
k=2
my.dmultinorm(x = y,mu = rep(0,length(y)),sigma=exp.cov.noise(x,thet,k),log=TRUE)
for(k in 1:(thet$K)){
log.P[k] = my.dmultinorm(x = y,mu = rep(0,length(y)),sigma=exp.cov.noise(x,thet,k),log=TRUE)
}
log.P
which.max(log.P)
z<-which.max(log.P)
calc.z.2<-function(x,y,thet){
log.P = print.posterior.1(x,y,thet)
z<-which.max(log.P)
}
k= calc.z.2(x,y,theta[[200]])
k
predict.gp(x,y,x.new,thet = theta[[200]],k)
predict.gp<-function(x,y,x.new,y.new,thet,k){
K.star<-exp.cov(x,x.new,thet,k)
K<-exp.cov.noise(x,thet,k)
K.inv <-ginv(K)
mu<- t(K.star)%*% K.inv %*% t(y)
sigma2<-exp.cov(x.new,x.new,thet,k) - t(K.star) %*% K.inv %*% (K.star)
sigma2<-diag(sigma2)
# correlation<-cor(mu,t(y.new))
result=c(list('pred.mean'=mu,'pred.sd'=sqrt(sigma2),'newdata'=x.new))
return(result)
}
predict.gp(x,y,x.new,thet = theta[[200]],k)
K.star<-exp.cov(x,x.new,thet,k)
K<-exp.cov.noise(x,thet,k)
K.inv <-ginv(K)
mu<- t(K.star)%*% K.inv %*% t(y)
sigma2<-exp.cov(x.new,x.new,thet,k) - t(K.star) %*% K.inv %*% (K.star)
sigma2<-diag(sigma2)
c(list('pred.mean'=mu,'pred.sd'=sqrt(sigma2),'newdata'=x.new))
predict.gp<-function(x,y,x.new,y.new,thet,k){
K.star<-exp.cov(x,x.new,thet,k)
K<-exp.cov.noise(x,thet,k)
K.inv <-ginv(K)
mu<- t(K.star)%*% K.inv %*% t(y)
sigma2<-exp.cov(x.new,x.new,thet,k) - t(K.star) %*% K.inv %*% (K.star)
sigma2<-diag(sigma2)
# correlation<-cor(mu,t(y.new))
result=c(list('pred.mean'=mu,'pred.sd'=sqrt(sigma2),'newdata'=x.new))
return(result)
}
predictdata = predict.gp(x,y,x.new,thet = theta[[200]],k)
predictdata$pred.mean
y.new = tempdata[x.new]
y.new
y.new = tempdata[x.new]
predictdata = predict.gp(x,y,x.new,y.new,thet = theta[[200]],k)
y.new - predictdata$pred.mean
predictdata$pred.mean
tempdata = read.table("testdata.dat",fill=TRUE)
RMSE = as.vector(rep(0,14*96-97))
for(ii in 1:(14*96-97)){
x = seq(ii,ii+95)
y = tempdata[ii:(ii+95)]
x.new = ii+96
k= calc.z.2(x,y,theta[[200]])
y.new = tempdata[x.new]
predictdata = predict.gp(x,y,x.new,y.new,thet = theta[[200]],k)
RMSE[ii] = y.new - predictdata$pred.mean
}
sum(RMSE^2)/(length(RMSE)-1)
RMSE
sum(RMSE^2)/(length(RMSE)-1)
RMSE[[1]]
aaa=as.vector(RMSE)
sum(aaa^2)/(length(aaa)-1)
View(aaa)
aaa = as.matrix(aaa)
View(aaa)
View(aaa)
View(aaa)
plot(aaa)
range(aaa)
sum(aaa^2)
tempdata = read.table("testdata.dat",fill=TRUE)
RMSE = as.vector(rep(0,14*96-97))
aaa = 0.0
for(ii in 1:(14*96-97)){
x = seq(ii,ii+95)
y = tempdata[ii:(ii+95)]
x.new = ii+96
k= calc.z.2(x,y,theta[[200]])
y.new = tempdata[x.new]
predictdata = predict.gp(x,y,x.new,y.new,thet = theta[[200]],k)
RMSE[ii] = y.new - predictdata$pred.mean
aaa = aaa+RMSE[ii]^2
}
tempdata = read.table("testdata.dat",fill=TRUE)
RMSE = as.vector(rep(0,14*96-97))
aaa = 0.0
for(ii in 1:(14*96-97)){
x = seq(ii,ii+95)
y = tempdata[ii:(ii+95)]
x.new = ii+96
k= calc.z.2(x,y,theta[[200]])
y.new = tempdata[x.new]
predictdata = predict.gp(x,y,x.new,y.new,thet = theta[[200]],k)
RMSE[ii] = y.new - predictdata$pred.mean
aaa = aaa+RMSE[ii]^2
print(ii)
}
tempdata = read.table("testdata.dat",fill=TRUE)
RMSE = as.vector(rep(0,14*96-97))
aaa = 0.0
for(ii in 1:(14*96-97)){
x = seq(ii,ii+95)
y = tempdata[ii:(ii+95)]
x.new = ii+96
k= calc.z.2(x,y,theta[[200]])
y.new = tempdata[x.new]
predictdata = predict.gp(x,y,x.new,y.new,thet = theta[[200]],k)
RMSE[ii] = y.new - predictdata$pred.mean
aaa = aaa+RMSE[[ii]]^2
print(ii)
}
aaa
RMSE[1]
aaa/(length(RMSE))
tempdata = read.table("testdata.dat",fill=TRUE)
RMSE = as.vector(rep(0,14*96-97))
SD = as.vector(rep(0,14*96-97))
aaa = 0.0
for(ii in 1:(14*96-97)){
x = seq(ii,ii+95)
y = tempdata[ii:(ii+95)]
x.new = ii+96
k= calc.z.2(x,y,theta[[200]])
y.new = tempdata[x.new]
predictdata = predict.gp(x,y,x.new,y.new,thet = theta[[200]],k)
RMSE[ii] = y.new - predictdata$pred.mean
SD[ii] = predictdata$pred.sd
aaa = aaa+RMSE[[ii]]^2
print(ii)
}
aaa/(length(RMSE))
mean(SD)
seq(0,24,by = 24/96)
plot.z<-function(Time,load,z){
color = c("red","blue")
plot(-100,-100,xlim=c(0,96),ylim =range(load),xlab = "Time(h)" ,ylab = "Electric load(MW)")
for(i in 1:100){
lines(seq(0,24,by = 24/96),load[i,],col=color[z[[i]]])
}
}
plot.z(Time,load,z[20000,])
plot.z(Time,elecload,z[N,]+1)
source('readsts.R')
plot.z(Time,elecload,z[N,]+1)
tempdata = read.table("electric_load_2008.dat",fill=TRUE)
N = dim(z)[1]
curve.num = dim(tempdata)[1]/2
Nm = dim(tempdata)[2]
Time = tempdata[seq(1,200,by=2),]
elecload = tempdata[seq(2,200,by=2),]
plot.z(Time,elecload,z[N,]+1)
aaa = seq(0,24,by = 24/96)
24/96
plot.z<-function(Time,load,z){
color = c("red","blue")
plot(-100,-100,xlim=c(0,96),ylim =range(load),xlab = "Time(h)" ,ylab = "Electric load(MW)")
for(i in 1:100){
lines(seq(0.25,24,by = 24/96),load[i,],col=color[z[[i]]])
}
}
aaa = seq(0.25,24,by = 24/96)
plot.z(Time,elecload,z[N,]+1)
plot.z<-function(Time,load,z){
color = c("red","blue")
plot(-100,-100,xlim=c(0,24),ylim =range(load),xlab = "Time(h)" ,ylab = "Electric load(MW)")
for(i in 1:100){
lines(seq(0.25,24,by = 24/96),load[i,],col=color[z[[i]]])
}
}
plot.z(Time,elecload,z[N,]+1)
?mar
?par
plot.z<-function(Time,load,z){
color = c("red","blue")
op<-par(mar = c(5, 4, 4, 2) + 0.1)
plot(-100,-100,xlim=c(0,24),ylim =range(load),xlab = "Time(h)" ,ylab = "Electric load(MW)")
for(i in 1:100){
lines(seq(0.25,24,by = 24/96),load[i,],col=color[z[[i]]])
}
}
plot.z(Time,elecload,z[N,]+1)
plot.z<-function(Time,load,z){
color = c("red","blue")
op<-par(mar = c(5, 2, 4, 2) + 0.1)
plot(-100,-100,xlim=c(0,24),ylim =range(load),xlab = "Time(h)" ,ylab = "Electric load(MW)")
for(i in 1:100){
lines(seq(0.25,24,by = 24/96),load[i,],col=color[z[[i]]])
}
}
plot.z(Time,elecload,z[N,]+1)
plot.z<-function(Time,load,z){
color = c("red","blue")
op<-par(mar = c(5, 4, 4, 2) + 0.1)
plot(-100,-100,xlim=c(0,24),ylim =range(load),xlab = "Time(h)" ,ylab = "Electric load(MW)")
for(i in 1:100){
lines(seq(0.25,24,by = 24/96),load[i,],col=color[z[[i]]])
}
}
plot.z(Time,elecload,z[N,]+1)
plot.z<-function(Time,load,z){
color = c("red","blue")
op<-par(mar = c(5, 4, 4, 2) + 0.1,fig = c(0, 1, 0, 0.9))
plot(-100,-100,xlim=c(0,24),ylim =range(load),xlab = "Time(h)" ,ylab = "Electric load(MW)")
for(i in 1:100){
lines(seq(0.25,24,by = 24/96),load[i,],col=color[z[[i]]])
}
}
plot.z(Time,elecload,z[N,]+1)
plot.z<-function(Time,load,z){
color = c("red","blue")
op<-par(mar = c(5, 4, 4, 2) + 0.1)
plot(-100,-100,xlim=c(0,24),ylim =range(load),xlab = "Time(h)" ,ylab = "Electric load(MW)")
for(i in 1:100){
lines(seq(0.25,24,by = 24/96),load[i,],col=color[z[[i]]])
}
}
plot.z(Time,elecload,z[N,]+1)
plot.z<-function(Time,load,z){
color = c("red","blue")
op<-par(mar = c(5, 4, 4, 2) + 0.1)
plot(-100,-100,xlim=c(0,24),ylim =range(load),xlab = "Time(h)" ,ylab = "Electric load(MW)")
for(i in 1:100){
lines(seq(0.25,24,by = 24/96),load[i,],col=color[z[[i]]])
}
}
plot.z(Time,elecload,z[N,]+1)
plot.z<-function(Time,load,z){
color = c("red","blue")
op<-par(mar = c(5, 4, 4, 2) + 0.1,fig= c(0,0,0,0))
plot(-100,-100,xlim=c(0,24),ylim =range(load),xlab = "Time(h)" ,ylab = "Electric load(MW)")
for(i in 1:100){
lines(seq(0.25,24,by = 24/96),load[i,],col=color[z[[i]]])
}
}
plot.z(Time,elecload,z[N,]+1)
plot.z<-function(Time,load,z){
color = c("red","blue")
op<-par(mar = c(5, 4, 4, 2) + 0.1,mgp = c(3,1,0))
plot(-100,-100,xlim=c(0,24),ylim =range(load),xlab = "Time(h)" ,ylab = "Electric load(MW)")
for(i in 1:100){
lines(seq(0.25,24,by = 24/96),load[i,],col=color[z[[i]]])
}
}
plot.z(Time,elecload,z[N,]+1)
plot.z<-function(Time,load,z){
color = c("red","blue")
op<-par(mar = c(5, 4, 4, 2) + 0.1,mgp = c(1,1,0))
plot(-100,-100,xlim=c(0,24),ylim =range(load),xlab = "Time(h)" ,ylab = "Electric load(MW)")
for(i in 1:100){
lines(seq(0.25,24,by = 24/96),load[i,],col=color[z[[i]]])
}
}
plot.z(Time,elecload,z[N,]+1)
plot.z<-function(Time,load,z){
color = c("red","blue")
op<-par(mar = c(5, 4, 4, 2) + 0.1,mgp = c(3,1,0))
plot(-100,-100,xlim=c(0,24),ylim =range(load),xlab = "Time(h)" ,ylab = "Electric load(MW)")
for(i in 1:100){
lines(seq(0.25,24,by = 24/96),load[i,],col=color[z[[i]]])
}
}
plot.z(Time,elecload,z[N,]+1)
?xaxis
?axis
require(stats) # for rnorm
plot(1:4, rnorm(4), axes = FALSE)
axis(1, 1:4, LETTERS[1:4])
axis(2)
box() #- to make it look "as usual"
plot(1:7, rnorm(7), main = "axis() examples",
type = "s", xaxt = "n", frame = FALSE, col = "red")
axis(1, 1:7, LETTERS[1:7], col.axis = "blue")
# unusual options:
axis(4, col = "violet", col.axis = "dark violet", lwd = 2)
axis(3, col = "gold", lty = 2, lwd = 0.5)
lot(1:10, xaxt = "n")
axis(1, xaxp = c(2, 9, 7))
plot(1:10, xaxt = "n")
axis(1, xaxp = c(2, 9, 7))
## Changing default gap between labels:
plot(0:100, type="n", axes=FALSE, ann=FALSE)
title(quote("axis(1, .., gap.axis = f)," ~~ f >= 0))
axis(2, at = 5*(0:20), las = 1, gap.axis = 1/4)
gaps <- c(4, 2, 1, 1/2, 1/4, 0.1, 0)
chG <- paste0(ifelse(gaps == 1, "default:  ", ""),
"gap.axis=", formatC(gaps))
jj <- seq_along(gaps)
linG <- -2.5*(jj-1)
for(j in jj) {
isD <- gaps[j] == 1 # is default
axis (1, at=5*(0:20), gap.axis = gaps[j], padj=-1, line = linG[j],
col.axis = if(isD) "forest green" else 1, font.axis= 1+isD)
}
mtext(chG, side=1, padj=-1, line = linG -1/2, cex=3/4,
col = ifelse(gaps == 1, "forest green", "blue3"))
## now shrink the window (in x- and y-direction) and observe the axis labels drawn
plot.z<-function(Time,load,z){
color = c("red","blue")
op<-par(mar = c(5, 4, 4, 2) + 0.1,mgp = c(3,1,0))
plot(-100,-100,xlim=c(0,24),ylim =range(load),xlab = "Time(h)" ,ylab = "Electric load(MW)",xaxs = "i", yaxs ="i")
for(i in 1:100){
lines(seq(0.25,24,by = 24/96),load[i,],col=color[z[[i]]])
}
}
plot.z(Time,elecload,z[N,]+1)
axis(1,at = seq(0,24,by=6))
axis(1,at = seq(0,24,by=4))
plot.z<-function(Time,load,z){
color = c("red","blue")
op<-par(mar = c(5, 4, 4, 2) + 0.1,mgp = c(3,1,0))
plot(-100,-100,xlim=c(0,24),ylim =range(load),xlab = "Time(h)" ,ylab = "Electric load(MW)",xaxs = "i", yaxs ="i")
for(i in 1:100){
lines(seq(0.25,24,by = 24/96),load[i,],col=color[z[[i]]])
}
axis(1,at = seq(0,24,by=4))
}
plot.z(Time,elecload,z[N,]+1)
?plot
plot.z<-function(Time,load,z){
color = c("red","blue")
op<-par(mar = c(5, 4, 4, 2) + 0.1,mgp = c(3,1,0))
plot(-100,-100,xlim=c(0,24),ylim =range(load),xlab = "Time(h)" ,ylab = "Electric load(MW)",xaxs = "i", yaxs ="i")
axis(1,at = seq(0,24,by=4))
for(i in 1:100){
lines(seq(0.25,24,by = 24/96),load[i,],col=color[z[[i]]])
}
# axis(1,at = seq(0,24,by=4))
}
plot.z(Time,elecload,z[N,]+1)
?plot
plot.z<-function(Time,load,z){
color = c("red","blue")
op<-par(mar = c(5, 4, 4, 2) + 0.1,mgp = c(3,1,0))
plot(-100,-100,xlim=c(0,24),ylim =range(load),xlab = "Time(h)" ,ylab = "Electric load(MW)",xaxs = "i", yaxs ="i",xaxt="n")
axis(1,at = seq(0,24,by=4))
for(i in 1:100){
lines(seq(0.25,24,by = 24/96),load[i,],col=color[z[[i]]])
}
# axis(1,at = seq(0,24,by=4))
}
plot.z(Time,elecload,z[N,]+1)
range(elecload)
plot.z<-function(Time,load,z){
color = c("red","blue")
op<-par(mar = c(5, 4, 4, 2) + 0.1,mgp = c(3,1,0))
plot(-100,-100,xlim=c(0,24),ylim =range(load),xlab = "Time(h)" ,ylab = "Electric load(MW)",xaxs = "i", yaxs ="i",xaxt="n",yaxt="n")
axis(1,at = seq(0,24,by=4))
axis(2,at=seq(4,10))
for(i in 1:100){
lines(seq(0.25,24,by = 24/96),load[i,],col=color[z[[i]]])
}
# axis(1,at = seq(0,24,by=4))
}
plot.z(Time,elecload,z[N,]+1)
plot(-100,-100,xlim=c(0,24),ylim =range(load),xlab = "Time(h)" ,ylab = "Electric load(MW)",xaxs = "i", yaxs ="i",xaxt="n",yaxt="n")
axis(1,at = seq(0,24,by=4))
plot(-100,-100,xlim=c(0,24),ylim =range(load),xlab = "Time(h)" ,ylab = "Electric load(MW)",xaxs = "i", yaxs ="i",xaxt="n",yaxt="n")
plot(-100,-100,xlim=c(0,24),ylim =range(load),ylim=c(4,10),xlab = "Time(h)" ,ylab = "Electric load(MW)",xaxs = "i", yaxs ="i",xaxt="n",yaxt="n")
plot(-100,-100,xlim=c(0,24),ylim=c(4,10),xlab = "Time(h)" ,ylab = "Electric load(MW)",xaxs = "i", yaxs ="i",xaxt="n",yaxt="n")
axis(1,at = seq(0,24,by=4))
axis(2,at=seq(4,10,by=1))
for(i in 1:100){
lines(seq(0.25,24,by = 24/96),load[i,],col=color[z[[i]]])
}
plot.z<-function(Time,load,z){
color = c("red","blue")
op<-par(mar = c(5, 4, 4, 2) + 0.1,mgp = c(3,1,0))
plot(-100,-100,xlim=c(0,24),ylim=c(4,10),xlab = "Time(h)" ,ylab = "Electric load(MW)",xaxs = "i", yaxs ="i",xaxt="n",yaxt="n")
axis(1,at = seq(0,24,by=4))
axis(2,at=seq(4,10,by=1))
for(i in 1:100){
lines(seq(0.25,24,by = 24/96),load[i,],col=color[z[[i]]])
}
# axis(1,at = seq(0,24,by=4))
}
plot.z(Time,elecload,z[N,]+1)
plot.z<-function(Time,load,z){
color = c("red","blue")
op<-par(mar = c(5, 4, 4, 2) + 0.1,mgp = c(3,1,0))
plot(-100,-100,xlim=c(0,24),ylim=c(4,10),xlab = "Time(h)" ,ylab = "Electric load(10^3MW)",xaxs = "i", yaxs ="i",xaxt="n",yaxt="n")
axis(1,at = seq(0,24,by=4))
axis(2,at=seq(4,10,by=1))
for(i in 1:100){
lines(seq(0.25,24,by = 24/96),load[i,],col=color[z[[i]]])
}
# axis(1,at = seq(0,24,by=4))
}
plot.z(Time,elecload,z[N,]+1)
plot(-100,-100,xlim=c(0,24),ylim=c(4,10),xlab = "Time(h)" ,ylab = expression(Electric~load(10^3MW)),xaxs = "i", yaxs ="i",xaxt="n",yaxt="n")
?expression
plot(-100,-100,xlim=c(0,24),ylim=c(4,10),xlab = "Time(h)" ,ylab = expression(10^3MW),xaxs = "i", yaxs ="i",xaxt="n",yaxt="n")
expression(10^3MW)
expression(10^3)
plot(-100,-100,xlim=c(0,24),ylim=c(4,10),xlab = "Time(h)" ,ylab = expression(10^3),xaxs = "i", yaxs ="i",xaxt="n",yaxt="n")
plot(-100,-100,xlim=c(0,24),ylim=c(4,10),xlab = "Time(h)" ,ylab = expression("Electric",10^3),xaxs = "i", yaxs ="i",xaxt="n",yaxt="n")
?paste
paste("Elec",expression(10^3))
plot(-100,-100,xlim=c(0,24),ylim=c(4,10),xlab = "Time(h)" ,ylab = paste("Electric load",expression(10^3),"MW"),xaxs = "i", yaxs ="i",xaxt="n",yaxt="n")
expression(10^3)
plot(-100,-100,xlim=c(0,24),ylim=c(4,10),xlab = "Time(h)" ,ylab = expression(paste("Electric load",10^3,"MW")),xaxs = "i", yaxs ="i",xaxt="n",yaxt="n")
?expression
?paste
plot(-100,-100,xlim=c(0,24),ylim=c(4,10),xlab = "Time(h)" ,ylab = expression(paste("Electric load",10^3,"MW",sep = " ")),xaxs = "i", yaxs ="i",xaxt="n",yaxt="n")
plot.z<-function(Time,load,z){
color = c("red","blue")
op<-par(mar = c(5, 4, 4, 2) + 0.1,mgp = c(3,1,0))
plot(-100,-100,xlim=c(0,24),ylim=c(4,10),xlab = "Time(h)" ,ylab = expression(paste("Electric load",10^3,"MW",sep = " ")),xaxs = "i", yaxs ="i",xaxt="n",yaxt="n")
axis(1,at = seq(0,24,by=4))
axis(2,at=seq(4,10,by=1))
for(i in 1:100){
lines(seq(0.25,24,by = 24/96),load[i,],col=color[z[[i]]])
}
# axis(1,at = seq(0,24,by=4))
}
plot.z(Time,elecload,z[N,]+1)
plot.z<-function(Time,load,z){
color = c("red","blue")
op<-par(mar = c(5, 4, 4, 2) + 0.1,mgp = c(3,1,0))
plot(-100,-100,xlim=c(0,24),ylim=c(4,10),xlab = "Time(h)" ,ylab = expression(paste("Electric load(",10^3,"MW)",sep = " ")),xaxs = "i", yaxs ="i",xaxt="n",yaxt="n")
axis(1,at = seq(0,24,by=4))
axis(2,at=seq(4,10,by=1))
for(i in 1:100){
lines(seq(0.25,24,by = 24/96),load[i,],col=color[z[[i]]])
}
# axis(1,at = seq(0,24,by=4))
}
plot.z(Time,elecload,z[N,]+1)
op<-par(mar = c(5, 4, 4, 2) + 0.1,mgp = c(2,1,0))
plot(-100,-100,xlim=c(0,24),ylim=c(4,10),xlab = "Time(h)" ,ylab = expression(paste("Electric load(",10^3,"MW)",sep = " ")),xaxs = "i", yaxs ="i",xaxt="n",yaxt="n")
plot.z<-function(Time,load,z){
color = c("red","blue")
op<-par(mar = c(5, 4, 4, 2) + 0.1,mgp = c(2,1,0))
plot(-100,-100,xlim=c(0,24),ylim=c(4,10),xlab = "Time(h)" ,ylab = expression(paste("Electric load(",10^3,"MW)",sep = " ")),xaxs = "i", yaxs ="i",xaxt="n",yaxt="n")
axis(1,at = seq(0,24,by=4))
axis(2,at=seq(4,10,by=1))
for(i in 1:100){
lines(seq(0.25,24,by = 24/96),load[i,],col=color[z[[i]]])
}
# axis(1,at = seq(0,24,by=4))
}
plot.z(Time,elecload,z[N,]+1)
24851/60
24851/60/60
